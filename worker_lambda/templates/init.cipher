CALL apoc.cypher.runMany(
'
{# 既存のノードを全て削除 #}
MATCH (n) DETACH DELETE n;

{# 制約の設定 #}
CREATE CONSTRAINT c_database_role_name_is_unique IF NOT EXISTS FOR (node:DatabaseRole) REQUIRE node.name IS UNIQUE;
CREATE CONSTRAINT c_functional_role_name_is_unique IF NOT EXISTS FOR (node:FunctionalRole) REQUIRE node.name IS UNIQUE;
CREATE CONSTRAINT c_access_role_name_is_unique IF NOT EXISTS FOR (node:AccessRole) REQUIRE node.name IS UNIQUE;

{# データベースロールの代入 #}
UNWIND $database_role_csv_params AS csvParam
CREATE (n:DatabaseRole)
SET n = csvParam;

{# 機能ロールの代入 #}
UNWIND $functional_role_csv_params AS csvParam
CREATE (n:FunctionalRole)
SET n = csvParam;

{# アクセスロールの代入 #}
UNWIND $access_role_csv_params AS csvParam
CREATE (n:AccessRole)
SET n = csvParam;

{# データベースロールの継承の代入 #}
UNWIND range(0, size($database_role_inheritance_csv_params) - 1) AS i
MERGE (child:DatabaseRole {name: $database_role_inheritance_csv_params[i].child})
MERGE (parent:AccessRole {name: $database_role_inheritance_csv_params[i].parent})
MERGE (parent)-[rel:INHERITS_FROM]->(child);

{# 機能ロールの継承の代入 #}
UNWIND range(0, size($functional_role_inheritance_csv_params) - 1) AS i
MERGE (child:FunctionalRole {name: $functional_role_inheritance_csv_params[i].child})
MERGE (parent:FunctionalRole {name: $functional_role_inheritance_csv_params[i].parent})
MERGE (parent)-[rel:INHERITS_FROM]->(child);

{# 機能アクセスロールの継承の代入 #}
UNWIND range(0, size($functional_access_role_inheritance_csv_params) - 1) AS i
MERGE (child:AccessRole {name: $functional_access_role_inheritance_csv_params[i].child})
MERGE (parent:FunctionalRole {name: $functional_access_role_inheritance_csv_params[i].parent})
MERGE (parent)-[rel:INHERITS_FROM]->(child);

{# アクセスロールの継承の代入 #}
UNWIND range(0, size($access_role_inheritance_csv_params) - 1) AS i
MERGE (child:AccessRole {name: $access_role_inheritance_csv_params[i].child})
MERGE (parent:AccessRole {name: $access_role_inheritance_csv_params[i].parent})
MERGE (parent)-[rel:INHERITS_FROM]->(child);

'
,{database_role_csv_params: $database_role_csv_params, functional_role_csv_params: $functional_role_csv_params, access_role_csv_params: $access_role_csv_params
,database_role_inheritance_csv_params: $database_role_inheritance_csv_params, functional_role_inheritance_csv_params: $functional_role_inheritance_csv_params, functional_access_role_inheritance_csv_params: $functional_access_role_inheritance_csv_params, access_role_inheritance_csv_params: $access_role_inheritance_csv_params}
)
